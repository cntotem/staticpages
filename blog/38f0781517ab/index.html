<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="ä¹å¤©å›¾è…¾,åšå®¢"><meta name="description" content="ä¹å¤©å›¾è…¾ä¸ªäººåšå®¢"><meta name="author" content="ä¹å¤©å›¾è…¾"><title>åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç† | ä¹å¤©å›¾è…¾</title><link rel="stylesheet" href="../css/style.css"><link rel="shortcut icon" href="../images/logo.svg"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/css/font-awesome.min.css"><script id="hexo-configurations">let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"blog.yusei.zone",root:"/",language:"zh-CN",path:"search.xml"},KEEP.theme_config={toc:{enable:!0,number:!1,expand_all:!1,init_open:!1},style:{primary_color:"#0066CC",avatar:"/images/avatar.jpeg",favicon:"/images/logo.svg",article_img_align:"center",left_side_width:"260px",content_max_width:"920px",hover:{shadow:!0,scale:!0},first_screen:{enable:!0,background_img:"/images/bg.svg",description:"æ‰€è°“å“è¶Šï¼Œå¹¶éæŒ‡è¡Œä¸ºï¼Œè€Œæ˜¯ä¹ æƒ¯ã€‚"},scroll:{progress_bar:{enable:!0},percent:{enable:!0}}},local_search:{enable:!0,preload:!0},code_copy:{enable:!0,style:"default"},pjax:{enable:!1},lazyload:{enable:!1},version:"3.4.3"},KEEP.language_ago={second:"%s ç§’å‰",minute:"%s åˆ†é’Ÿå‰",hour:"%s å°æ—¶å‰",day:"%s å¤©å‰",week:"%s å‘¨å‰",month:"%s æœˆå‰",year:"%s å¹´å‰"}</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="atom.xml" title="ä¹å¤©å›¾è…¾" type="application/atom+xml">
</head><body><div class="progress-bar-container"><span class="scroll-progress-bar"></span></div><main class="page-container"><div class="page-main-content"><div class="page-main-content-top"><header class="header-wrapper"><div class="header-content"><div class="left"><a class="logo-title" href="/">ä¹å¤©å›¾è…¾</a></div><div class="right"><div class="pc"><ul class="menu-list"><li class="menu-item"><a href="../index.html">é¦–é¡µ</a></li><li class="menu-item"><a href="../archives">å½’æ¡£</a></li><li class="menu-item"><a href="../links">å‹é“¾</a></li><li class="menu-item"><a href="../about">å…³äº</a></li><li class="menu-item search search-popup-trigger"><i class="fas fa-search"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class="menu-bar-middle"></div></div></div></div></div><div class="header-drawer"><ul class="drawer-menu-list"><li class="drawer-menu-item flex-center"><a href="../index.html">é¦–é¡µ</a></li><li class="drawer-menu-item flex-center"><a href="../archives">å½’æ¡£</a></li><li class="drawer-menu-item flex-center"><a href="../links">å‹é“¾</a></li><li class="drawer-menu-item flex-center"><a href="../about">å…³äº</a></li></ul></div><div class="window-mask"></div></header></div><div class="page-main-content-middle"><div class="main-content"><div class="fade-in-down-animation"><div class="article-content-container"><div class="article-title"><span class="title-hover-animation">åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†</span></div><div class="article-header"><div class="avatar"><img src="../images/avatar.jpeg"></div><div class="info"><div class="author"><span class="name">ä¹å¤©å›¾è…¾</span> <span class="author-label">åŒ–å¢ƒæœŸ</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fas fa-edit"></i>&nbsp;2019-06-04 23:42:00 </span><span class="article-categories article-meta-item"><i class="fas fa-folder"></i>&nbsp;<ul><li><a href="../categories/%E5%88%86%E5%B8%83%E5%BC%8F/">åˆ†å¸ƒå¼</a>&nbsp;</li></ul></span><span class="article-tags article-meta-item"><i class="fas fa-tags"></i>&nbsp;<ul><li><a href="../tags/%E5%88%86%E5%B8%83%E5%BC%8F/">åˆ†å¸ƒå¼</a>&nbsp;</li><li>| <a href="../tags/session/">session</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fas fa-file-word"></i>&nbsp;<span>2.8k å­—</span> </span><span class="article-min2read article-meta-item"><i class="fas fa-clock"></i>&nbsp;<span>11 åˆ†é’Ÿ</span> </span><span class="article-pv article-meta-item"><i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body"><h1 id="åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†"><a href="#åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†" class="headerlink" title="åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†"></a>åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†</h1><blockquote><p>ğŸ“¦ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ<a class="link" target="_blank" rel="noopener" href="https://github.com/dunwu/blog">blog<i class="fas fa-external-link-alt"></i></a>ã€</p><p>ç”±äº Http æ˜¯ä¸€ç§æ— çŠ¶æ€çš„åè®®ï¼ŒæœåŠ¡å™¨å•å•ä»ç½‘ç»œè¿æ¥ä¸Šæ— ä»çŸ¥é“å®¢æˆ·èº«ä»½ã€‚</p><p>ä¼šè¯è·Ÿè¸ªæ˜¯ Web ç¨‹åºä¸­å¸¸ç”¨çš„æŠ€æœ¯ï¼Œç”¨æ¥è·Ÿè¸ªç”¨æˆ·çš„æ•´ä¸ªä¼šè¯ã€‚å¸¸ç”¨ä¼šè¯è·Ÿè¸ªæŠ€æœ¯æ˜¯ Cookie ä¸ Sessionã€‚</p></blockquote><ul><li><a href="#1-%E7%AE%80%E4%BB%8B">1. ç®€ä»‹</a><ul><li><a href="#11-%E4%BB%80%E4%B9%88%E6%98%AF-cookie">1.1. ä»€ä¹ˆæ˜¯ Cookie</a></li><li><a href="#12-%E4%BB%80%E4%B9%88%E6%98%AF-session">1.2. ä»€ä¹ˆæ˜¯ Session</a></li><li><a href="#13-cookie-%E5%92%8C-session-%E7%9A%84%E5%8C%BA%E5%88%AB">1.3. Cookie å’Œ Session çš„åŒºåˆ«</a></li><li><a href="#14-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-cookie-%E5%92%8C-session%E4%BB%96%E4%BB%AC%E6%9C%89%E4%BB%80%E4%B9%88%E5%85%B3%E8%81%94">1.4. ä¸ºä»€ä¹ˆéœ€è¦ Cookie å’Œ Sessionï¼Œä»–ä»¬æœ‰ä»€ä¹ˆå…³è”ï¼Ÿ</a></li><li><a href="#15-%E5%A6%82%E6%9E%9C%E6%B5%8F%E8%A7%88%E5%99%A8%E7%A6%81%E7%94%A8-cookie-%E6%80%8E%E4%B9%88%E5%8A%9E">1.5. å¦‚æœæµè§ˆå™¨ç¦ç”¨ Cookie æ€ä¹ˆåŠ</a></li></ul></li><li><a href="#2-%E5%88%86%E5%B8%83%E5%BC%8F-session">2. åˆ†å¸ƒå¼ Session</a><ul><li><a href="#21-%E7%B2%98%E6%80%A7-session">2.1. ç²˜æ€§ Session</a></li><li><a href="#22-session-%E5%A4%8D%E5%88%B6%E5%85%B1%E4%BA%AB">2.2. Session å¤åˆ¶å…±äº«</a></li><li><a href="#23-%E5%9F%BA%E4%BA%8E%E7%BC%93%E5%AD%98%E7%9A%84-session-%E5%85%B1%E4%BA%AB">2.3. åŸºäºç¼“å­˜çš„ session å…±äº«</a></li></ul></li><li><a href="#3-%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0">3. å…·ä½“å®ç°</a><ul><li><a href="#31-jwt-token">3.1. JWT Token</a></li><li><a href="#32-tomcat--redis">3.2. tomcat + redis</a></li><li><a href="#33-spring-session--redis">3.3. spring session + redis</a></li></ul></li><li><a href="#4-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">4. å‚è€ƒèµ„æ–™</a></li></ul><h2 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1. ç®€ä»‹"></a>1. ç®€ä»‹</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯-Cookie"><a href="#1-1-ä»€ä¹ˆæ˜¯-Cookie" class="headerlink" title="1.1. ä»€ä¹ˆæ˜¯ Cookie"></a>1.1. ä»€ä¹ˆæ˜¯ Cookie</h3><p>Cookie å®é™…ä¸Šæ˜¯å­˜å‚¨åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸Šçš„æ–‡æœ¬ä¿¡æ¯ï¼Œå¹¶ä¿ç•™äº†å„ç§è·Ÿè¸ªçš„ä¿¡æ¯ã€‚</p><p>Cookie å·¥ä½œæ­¥éª¤ï¼š</p><ol><li>å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦è®°å½•è¯¥ç”¨æˆ·çš„çŠ¶æ€ï¼Œå°±æ˜¯ç”¨ response å‘å®¢æˆ·ç«¯æµè§ˆå™¨é¢å‘ä¸€ä¸ª Cookieã€‚</li><li>å®¢æˆ·ç«¯æµè§ˆå™¨ä¼šæŠŠ Cookie ä¿å­˜ä¸‹æ¥ã€‚</li><li>å½“æµè§ˆå™¨å†è¯·æ±‚è¯¥ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨æŠŠè¯¥è¯·æ±‚çš„ç½‘å€è¿åŒ Cookie ä¸€åŒæäº¤ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨æ£€æŸ¥è¯¥ Cookieï¼Œä»¥æ­¤æ¥è¾¨è®¤ç”¨æˆ·çŠ¶æ€ã€‚</li></ol><p>Cookie ä¸»è¦ç”¨äºä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢ï¼š</p><ul><li>ä¼šè¯çŠ¶æ€ç®¡ç†ï¼ˆå¦‚ç”¨æˆ·ç™»å½•çŠ¶æ€ã€è´­ç‰©è½¦ã€æ¸¸æˆåˆ†æ•°æˆ–å…¶å®ƒéœ€è¦è®°å½•çš„ä¿¡æ¯ï¼‰</li><li>ä¸ªæ€§åŒ–è®¾ç½®ï¼ˆå¦‚ç”¨æˆ·è‡ªå®šä¹‰è®¾ç½®ã€ä¸»é¢˜ç­‰ï¼‰</li><li>æµè§ˆå™¨è¡Œä¸ºè·Ÿè¸ªï¼ˆå¦‚è·Ÿè¸ªåˆ†æç”¨æˆ·è¡Œä¸ºç­‰ï¼‰</li></ul><p><em><strong>æ³¨ï¼šCookie åŠŸèƒ½éœ€è¦æµè§ˆå™¨çš„æ”¯æŒï¼Œå¦‚æœæµè§ˆå™¨ä¸æ”¯æŒ Cookie æˆ–è€… Cookie ç¦ç”¨äº†ï¼ŒCookie åŠŸèƒ½å°±ä¼šå¤±æ•ˆã€‚</strong></em></p><h3 id="1-2-ä»€ä¹ˆæ˜¯-Session"><a href="#1-2-ä»€ä¹ˆæ˜¯-Session" class="headerlink" title="1.2. ä»€ä¹ˆæ˜¯ Session"></a>1.2. ä»€ä¹ˆæ˜¯ Session</h3><p>Session ä»£è¡¨ç€æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸€æ¬¡ä¼šè¯çš„è¿‡ç¨‹ã€‚Session å¯¹è±¡å­˜å‚¨ç‰¹å®šç”¨æˆ·ä¼šè¯æ‰€éœ€çš„å±æ€§åŠé…ç½®ä¿¡æ¯ã€‚è¿™æ ·ï¼Œå½“ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºçš„ Web é¡µä¹‹é—´è·³è½¬æ—¶ï¼Œå­˜å‚¨åœ¨ Session å¯¹è±¡ä¸­çš„å˜é‡å°†ä¸ä¼šä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æ•´ä¸ªç”¨æˆ·ä¼šè¯ä¸­ä¸€ç›´å­˜åœ¨ä¸‹å»ã€‚å½“å®¢æˆ·ç«¯å…³é—­ä¼šè¯ï¼Œæˆ–è€… Session è¶…æ—¶å¤±æ•ˆæ—¶ä¼šè¯ç»“æŸã€‚</p><h3 id="1-3-Cookie-å’Œ-Session-çš„åŒºåˆ«"><a href="#1-3-Cookie-å’Œ-Session-çš„åŒºåˆ«" class="headerlink" title="1.3. Cookie å’Œ Session çš„åŒºåˆ«"></a>1.3. Cookie å’Œ Session çš„åŒºåˆ«</h3><ul><li><strong>ä½œç”¨èŒƒå›´ä¸åŒ</strong>ï¼ŒCookie ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ï¼ŒSession ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ã€‚</li><li><strong>å­˜å–æ–¹å¼çš„ä¸åŒ</strong>ï¼ŒCookie åªèƒ½ä¿å­˜ ASCIIï¼ŒSession å¯ä»¥å­˜ä»»æ„æ•°æ®ç±»å‹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥åœ¨ Session ä¸­ä¿æŒä¸€äº›å¸¸ç”¨å˜é‡ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ UserId ç­‰ã€‚</li><li><strong>æœ‰æ•ˆæœŸä¸åŒ</strong>ï¼ŒCookie å¯è®¾ç½®ä¸ºé•¿æ—¶é—´ä¿æŒï¼Œæ¯”å¦‚æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„é»˜è®¤ç™»å½•åŠŸèƒ½ï¼ŒSession ä¸€èˆ¬å¤±æ•ˆæ—¶é—´è¾ƒçŸ­ï¼Œå®¢æˆ·ç«¯å…³é—­æˆ–è€… Session è¶…æ—¶éƒ½ä¼šå¤±æ•ˆã€‚</li><li><strong>éšç§ç­–ç•¥ä¸åŒ</strong>ï¼ŒCookie å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œæ¯”è¾ƒå®¹æ˜“é­åˆ°ä¸æ³•è·å–ï¼Œæ—©æœŸæœ‰äººå°†ç”¨æˆ·çš„ç™»å½•åå’Œå¯†ç å­˜å‚¨åœ¨ Cookie ä¸­å¯¼è‡´ä¿¡æ¯è¢«çªƒå–ï¼›Session å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œå®‰å…¨æ€§ç›¸å¯¹ Cookie è¦å¥½ä¸€äº›ã€‚</li><li><strong>å­˜å‚¨å¤§å°ä¸åŒ</strong>ï¼Œ å•ä¸ª Cookie ä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡ 4Kï¼ŒSession å¯å­˜å‚¨æ•°æ®è¿œé«˜äº Cookieã€‚</li></ul><h3 id="1-4-ä¸ºä»€ä¹ˆéœ€è¦-Cookie-å’Œ-Sessionï¼Œä»–ä»¬æœ‰ä»€ä¹ˆå…³è”ï¼Ÿ"><a href="#1-4-ä¸ºä»€ä¹ˆéœ€è¦-Cookie-å’Œ-Sessionï¼Œä»–ä»¬æœ‰ä»€ä¹ˆå…³è”ï¼Ÿ" class="headerlink" title="1.4. ä¸ºä»€ä¹ˆéœ€è¦ Cookie å’Œ Sessionï¼Œä»–ä»¬æœ‰ä»€ä¹ˆå…³è”ï¼Ÿ"></a>1.4. ä¸ºä»€ä¹ˆéœ€è¦ Cookie å’Œ Sessionï¼Œä»–ä»¬æœ‰ä»€ä¹ˆå…³è”ï¼Ÿ</h3><p>è¯´èµ·æ¥ä¸ºä»€ä¹ˆéœ€è¦ Cookie ï¼Œè¿™å°±éœ€è¦ä»æµè§ˆå™¨å¼€å§‹è¯´èµ·ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“æµè§ˆå™¨æ˜¯æ²¡æœ‰çŠ¶æ€çš„(HTTP åè®®æ— çŠ¶æ€)ï¼Œè¿™æ„å‘³ç€æµè§ˆå™¨å¹¶ä¸çŸ¥é“æ˜¯å¼ ä¸‰è¿˜æ˜¯æå››åœ¨å’ŒæœåŠ¡ç«¯æ‰“äº¤é“ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦æœ‰ä¸€ä¸ªæœºåˆ¶æ¥å‘Šè¯‰æœåŠ¡ç«¯ï¼Œæœ¬æ¬¡æ“ä½œç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œæ˜¯å“ªä¸ªç”¨æˆ·åœ¨æ‰§è¡Œçš„æ“ä½œï¼Œé‚£è¿™å¥—æœºåˆ¶çš„å®ç°å°±éœ€è¦ Cookie å’Œ Session çš„é…åˆã€‚</p><p>é‚£ä¹ˆ Cookie å’Œ Session æ˜¯å¦‚ä½•é…åˆçš„å‘¢ï¼Ÿæˆ‘ç”»äº†ä¸€å¼ å›¾å¤§å®¶å¯ä»¥å…ˆäº†è§£ä¸‹ã€‚</p><p><img src="https://user-gold-cdn.xitu.io/2019/5/13/16aafb5d90f398e2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p><p>ç”¨æˆ·ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨æ ¹æ®ç”¨æˆ·æäº¤çš„ç›¸å…³ä¿¡æ¯ï¼Œåˆ›å»ºåˆ›å»ºå¯¹åº”çš„ Session ï¼Œè¯·æ±‚è¿”å›æ—¶å°†æ­¤ Session çš„å”¯ä¸€æ ‡è¯†ä¿¡æ¯ SessionID è¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ¥æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„ SessionID ä¿¡æ¯åï¼Œä¼šå°†æ­¤ä¿¡æ¯å­˜å…¥åˆ° Cookie ä¸­ï¼ŒåŒæ—¶ Cookie è®°å½•æ­¤ SessionID å±äºå“ªä¸ªåŸŸåã€‚</p><p>å½“ç”¨æˆ·ç¬¬äºŒæ¬¡è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ï¼Œè¯·æ±‚ä¼šè‡ªåŠ¨åˆ¤æ–­æ­¤åŸŸåä¸‹æ˜¯å¦å­˜åœ¨ Cookie ä¿¡æ¯ï¼Œå¦‚æœå­˜åœ¨è‡ªåŠ¨å°† Cookie ä¿¡æ¯ä¹Ÿå‘é€ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¼šä» Cookie ä¸­è·å– SessionIDï¼Œå†æ ¹æ® SessionID æŸ¥æ‰¾å¯¹åº”çš„ Session ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¯´æ˜ç”¨æˆ·æ²¡æœ‰ç™»å½•æˆ–è€…ç™»å½•å¤±æ•ˆï¼Œå¦‚æœæ‰¾åˆ° Session è¯æ˜ç”¨æˆ·å·²ç»ç™»å½•å¯æ‰§è¡Œåé¢æ“ä½œã€‚</p><p>æ ¹æ®ä»¥ä¸Šæµç¨‹å¯çŸ¥ï¼ŒSessionID æ˜¯è¿æ¥ Cookie å’Œ Session çš„ä¸€é“æ¡¥æ¢ï¼Œå¤§éƒ¨åˆ†ç³»ç»Ÿä¹Ÿæ˜¯æ ¹æ®æ­¤åŸç†æ¥éªŒè¯ç”¨æˆ·ç™»å½•çŠ¶æ€ã€‚</p><h3 id="1-5-å¦‚æœæµè§ˆå™¨ç¦ç”¨-Cookie-æ€ä¹ˆåŠ"><a href="#1-5-å¦‚æœæµè§ˆå™¨ç¦ç”¨-Cookie-æ€ä¹ˆåŠ" class="headerlink" title="1.5. å¦‚æœæµè§ˆå™¨ç¦ç”¨ Cookie æ€ä¹ˆåŠ"></a>1.5. å¦‚æœæµè§ˆå™¨ç¦ç”¨ Cookie æ€ä¹ˆåŠ</h3><p>æ—¢ç„¶æœåŠ¡ç«¯æ˜¯æ ¹æ® Cookie ä¸­çš„ä¿¡æ¯åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œé‚£ä¹ˆå¦‚æœæµè§ˆå™¨ä¸­ç¦æ­¢äº† Cookieï¼Œå¦‚ä½•ä¿éšœæ•´ä¸ªæœºåˆ¶çš„æ­£å¸¸è¿è½¬ã€‚</p><p>ç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œæ¯æ¬¡è¯·æ±‚ä¸­éƒ½æºå¸¦ä¸€ä¸ª SessionID çš„å‚æ•°ï¼Œä¹Ÿå¯ä»¥ Post çš„æ–¹å¼æäº¤ï¼Œä¹Ÿå¯ä»¥åœ¨è¯·æ±‚çš„åœ°å€åé¢æ‹¼æ¥ <code>xxx?SessionID=123456...</code>ã€‚</p><p>ç¬¬äºŒç§æ–¹æ¡ˆï¼ŒToken æœºåˆ¶ã€‚Token æœºåˆ¶å¤šç”¨äº App å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨äº¤äº’çš„æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥ç”¨äº Web ç«¯åšç”¨æˆ·çŠ¶æ€ç®¡ç†ã€‚</p><p>Token çš„æ„æ€æ˜¯â€œä»¤ç‰Œâ€ï¼Œæ˜¯æœåŠ¡ç«¯ç”Ÿæˆçš„ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œä½œä¸ºå®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚çš„ä¸€ä¸ªæ ‡è¯†ã€‚Token æœºåˆ¶å’Œ Cookie å’Œ Session çš„ä½¿ç”¨æœºåˆ¶æ¯”è¾ƒç±»ä¼¼ã€‚</p><p>å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡ç™»å½•åï¼ŒæœåŠ¡å™¨æ ¹æ®æäº¤çš„ç”¨æˆ·ä¿¡æ¯ç”Ÿæˆä¸€ä¸ª Tokenï¼Œå“åº”æ—¶å°† Token è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä»¥åå®¢æˆ·ç«¯åªéœ€å¸¦ä¸Šè¿™ä¸ª Token å‰æ¥è¯·æ±‚æ•°æ®å³å¯ï¼Œæ— éœ€å†æ¬¡ç™»å½•éªŒè¯ã€‚</p><h2 id="2-åˆ†å¸ƒå¼-Session"><a href="#2-åˆ†å¸ƒå¼-Session" class="headerlink" title="2. åˆ†å¸ƒå¼ Session"></a>2. åˆ†å¸ƒå¼ Session</h2><p>åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œä¸€ä¸ªç”¨æˆ·çš„ Session å¦‚æœåªå­˜å‚¨åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œé‚£ä¹ˆå½“è´Ÿè½½å‡è¡¡å™¨æŠŠç”¨æˆ·çš„ä¸‹ä¸€ä¸ªè¯·æ±‚è½¬å‘åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œè¯¥æœåŠ¡å™¨æ²¡æœ‰ç”¨æˆ·çš„ Sessionï¼Œå°±å¯èƒ½å¯¼è‡´ç”¨æˆ·éœ€è¦é‡æ–°è¿›è¡Œç™»å½•ç­‰æ“ä½œã€‚</p><p>åˆ†å¸ƒå¼ Session çš„å‡ ç§å®ç°ç­–ç•¥ï¼š</p><ol><li>ç²˜æ€§ session</li><li>åº”ç”¨æœåŠ¡å™¨é—´çš„ session å¤åˆ¶å…±äº«</li><li>åŸºäºç¼“å­˜çš„ session å…±äº« âœ…</li></ol><blockquote><p>æ¨èï¼šåŸºäºç¼“å­˜çš„ session å…±äº«</p></blockquote><h3 id="2-1-ç²˜æ€§-Session"><a href="#2-1-ç²˜æ€§-Session" class="headerlink" title="2.1. ç²˜æ€§ Session"></a>2.1. ç²˜æ€§ Session</h3><blockquote><p>ç²˜æ€§ Sessionï¼ˆSticky Sessionsï¼‰<strong>éœ€è¦é…ç½®è´Ÿè½½å‡è¡¡å™¨ï¼Œä½¿å¾—ä¸€ä¸ªç”¨æˆ·çš„æ‰€æœ‰è¯·æ±‚éƒ½è·¯ç”±åˆ°ä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ä¸Š</strong>ï¼Œè¿™æ ·å°±å¯ä»¥æŠŠç”¨æˆ·çš„ Session å­˜æ”¾åœ¨è¯¥æœåŠ¡å™¨èŠ‚ç‚¹ä¸­ã€‚</p><p>ç¼ºç‚¹ï¼š<strong>å½“æœåŠ¡å™¨èŠ‚ç‚¹å®•æœºæ—¶ï¼Œå°†ä¸¢å¤±è¯¥æœåŠ¡å™¨èŠ‚ç‚¹ä¸Šçš„æ‰€æœ‰ Session</strong>ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/cntotemdb/ih1@master/202106/hRXYPK.jpg"></p><h3 id="2-2-Session-å¤åˆ¶å…±äº«"><a href="#2-2-Session-å¤åˆ¶å…±äº«" class="headerlink" title="2.2. Session å¤åˆ¶å…±äº«"></a>2.2. Session å¤åˆ¶å…±äº«</h3><blockquote><p>Session å¤åˆ¶å…±äº«ï¼ˆSession Replicationï¼‰<strong>åœ¨æœåŠ¡å™¨èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œ Session åŒæ­¥æ“ä½œ</strong>ï¼Œè¿™æ ·çš„è¯ç”¨æˆ·å¯ä»¥è®¿é—®ä»»ä½•ä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ã€‚</p><p>ç¼ºç‚¹ï¼š<strong>å ç”¨è¿‡å¤šå†…å­˜</strong>ï¼›<strong>åŒæ­¥è¿‡ç¨‹å ç”¨ç½‘ç»œå¸¦å®½ä»¥åŠæœåŠ¡å™¨å¤„ç†å™¨æ—¶é—´</strong>ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/cntotemdb/ih1@master/202106/fO9KNs.jpg"></p><h3 id="2-3-åŸºäºç¼“å­˜çš„-session-å…±äº«"><a href="#2-3-åŸºäºç¼“å­˜çš„-session-å…±äº«" class="headerlink" title="2.3. åŸºäºç¼“å­˜çš„ session å…±äº«"></a>2.3. åŸºäºç¼“å­˜çš„ session å…±äº«</h3><blockquote><p><strong>ä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„å­˜å‚¨æœåŠ¡å™¨å­˜å‚¨ Session æ•°æ®</strong>ï¼Œå¯ä»¥å­˜åœ¨ MySQL æ•°æ®åº“ä¸Šï¼Œä¹Ÿå¯ä»¥å­˜åœ¨ Redis æˆ–è€… Memcached è¿™ç§å†…å­˜å‹æ•°æ®åº“ã€‚</p><p>ç¼ºç‚¹ï¼šéœ€è¦å»å®ç°å­˜å– Session çš„ä»£ç ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/cntotemdb/ih1@master/202106/n4ztlU.jpg"></p><h2 id="3-å…·ä½“å®ç°"><a href="#3-å…·ä½“å®ç°" class="headerlink" title="3. å…·ä½“å®ç°"></a>3. å…·ä½“å®ç°</h2><h3 id="3-1-JWT-Token"><a href="#3-1-JWT-Token" class="headerlink" title="3.1. JWT Token"></a>3.1. JWT Token</h3><p>ä½¿ç”¨ JWT Token å‚¨å­˜ç”¨æˆ·èº«ä»½ï¼Œç„¶åå†ä»æ•°æ®åº“æˆ–è€… cache ä¸­è·å–å…¶ä»–çš„ä¿¡æ¯ã€‚è¿™æ ·æ— è®ºè¯·æ±‚åˆ†é…åˆ°å“ªä¸ªæœåŠ¡å™¨éƒ½æ— æ‰€è°“ã€‚</p><h3 id="3-2-tomcat-redis"><a href="#3-2-tomcat-redis" class="headerlink" title="3.2. tomcat + redis"></a>3.2. tomcat + redis</h3><p>è¿™ä¸ªå…¶å®è¿˜æŒºæ–¹ä¾¿çš„ï¼Œå°±æ˜¯ä½¿ç”¨ session çš„ä»£ç ï¼Œè·Ÿä»¥å‰ä¸€æ ·ï¼Œè¿˜æ˜¯åŸºäº tomcat åŸç”Ÿçš„ session æ”¯æŒå³å¯ï¼Œç„¶åå°±æ˜¯ç”¨ä¸€ä¸ªå«åš <code>Tomcat RedisSessionManager</code> çš„ä¸œè¥¿ï¼Œè®©æ‰€æœ‰æˆ‘ä»¬éƒ¨ç½²çš„ tomcat éƒ½å°† session æ•°æ®å­˜å‚¨åˆ° redis å³å¯ã€‚</p><p>åœ¨ tomcat çš„é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Valve</span> <span class="attr">className</span>=<span class="string">&quot;com.orangefunction.tomcat.redissessions.RedisSessionHandlerValve&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">Manager</span> <span class="attr">className</span>=<span class="string">&quot;com.orangefunction.tomcat.redissessions.RedisSessionManager&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">host</span>=<span class="string">&quot;&#123;redis.host&#125;&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">port</span>=<span class="string">&quot;&#123;redis.port&#125;&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">database</span>=<span class="string">&quot;&#123;redis.dbnum&#125;&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">maxInactiveInterval</span>=<span class="string">&quot;60&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åæŒ‡å®š redis çš„ host å’Œ port å°± ok äº†ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Valve</span> <span class="attr">className</span>=<span class="string">&quot;com.orangefunction.tomcat.redissessions.RedisSessionHandlerValve&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Manager</span> <span class="attr">className</span>=<span class="string">&quot;com.orangefunction.tomcat.redissessions.RedisSessionManager&quot;</span></span></span><br><span class="line"><span class="tag">	 <span class="attr">sentinelMaster</span>=<span class="string">&quot;mymaster&quot;</span></span></span><br><span class="line"><span class="tag">	 <span class="attr">sentinels</span>=<span class="string">&quot;&lt;sentinel1-ip&gt;:26379,&lt;sentinel2-ip&gt;:26379,&lt;sentinel3-ip&gt;:26379&quot;</span></span></span><br><span class="line"><span class="tag">	 <span class="attr">maxInactiveInterval</span>=<span class="string">&quot;60&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ç”¨ä¸Šé¢è¿™ç§æ–¹å¼åŸºäº redis å“¨å…µæ”¯æŒçš„ redis é«˜å¯ç”¨é›†ç¾¤æ¥ä¿å­˜ session æ•°æ®ï¼Œéƒ½æ˜¯ ok çš„ã€‚</p><h3 id="3-3-spring-session-redis"><a href="#3-3-spring-session-redis" class="headerlink" title="3.3. spring session + redis"></a>3.3. spring session + redis</h3><p>ä¸Šé¢é‚£ç§ tomcat + redis çš„æ–¹å¼å¥½ç”¨ï¼Œä½†æ˜¯ä¼š<strong>ä¸¥é‡ä¾èµ–äº web å®¹å™¨</strong>ï¼Œä¸å¥½å°†ä»£ç ç§»æ¤åˆ°å…¶ä»– web å®¹å™¨ä¸Šå»ï¼Œå°¤å…¶æ˜¯ä½ è¦æ˜¯æ¢äº†æŠ€æœ¯æ ˆå’‹æ•´ï¼Ÿæ¯”å¦‚æ¢æˆäº† spring cloud æˆ–è€…æ˜¯ spring boot ä¹‹ç±»çš„å‘¢ï¼Ÿ</p><p>æ‰€ä»¥ç°åœ¨æ¯”è¾ƒå¥½çš„è¿˜æ˜¯åŸºäº Java ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯ springã€‚äººå®¶ spring åŸºæœ¬ä¸Šæ‰¿åŒ…äº†å¤§éƒ¨åˆ†æˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„æ¡†æ¶ï¼Œspirng cloud åšå¾®æœåŠ¡ï¼Œspring boot åšè„šæ‰‹æ¶ï¼Œæ‰€ä»¥ç”¨ <a class="link" target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-session">sping session<i class="fas fa-external-link-alt"></i></a> æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p><p>åœ¨ pom.xml ä¸­é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.session<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-session-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ spring é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;redisHttpSessionConfiguration&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">class</span>=<span class="string">&quot;org.springframework.session.data.redis.config.annotation.web.http.RedisHttpSessionConfiguration&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxInactiveIntervalInSeconds&quot;</span> <span class="attr">value</span>=<span class="string">&quot;600&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jedisPoolConfig&quot;</span> <span class="attr">class</span>=<span class="string">&quot;redis.clients.jedis.JedisPoolConfig&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxTotal&quot;</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxIdle&quot;</span> <span class="attr">value</span>=<span class="string">&quot;10&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jedisConnectionFactory&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;org.springframework.data.redis.connection.jedis.JedisConnectionFactory&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroy&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hostName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;redis_hostname&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;port&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;redis_port&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;redis_pwd&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;timeout&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3000&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;usePool&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;poolConfig&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;jedisPoolConfig&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ web.xml ä¸­é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>springSessionRepositoryFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/putIntoSession&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">putIntoSession</span><span class="params">(HttpServletRequest request, String username)</span> </span>&#123;</span><br><span class="line">        request.getSession().setAttribute(<span class="string">&quot;name&quot;</span>,  <span class="string">&quot;leo&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/getFromSession&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFromSession</span><span class="params">(HttpServletRequest request, Model model)</span></span>&#123;</span><br><span class="line">        String name = request.getSession().getAttribute(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç å°±æ˜¯ ok çš„ï¼Œç»™ sping session é…ç½®åŸºäº redis æ¥å­˜å‚¨ session æ•°æ®ï¼Œç„¶åé…ç½®äº†ä¸€ä¸ª spring session çš„è¿‡æ»¤å™¨ï¼Œè¿™æ ·çš„è¯ï¼Œsession ç›¸å…³æ“ä½œéƒ½ä¼šäº¤ç»™ spring session æ¥ç®¡äº†ã€‚æ¥ç€åœ¨ä»£ç ä¸­ï¼Œå°±ç”¨åŸç”Ÿçš„ session æ“ä½œï¼Œå°±æ˜¯ç›´æ¥åŸºäº spring sesion ä» redis ä¸­è·å–æ•°æ®äº†ã€‚</p><p>å®ç°åˆ†å¸ƒå¼çš„ä¼šè¯æœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œæˆ‘è¯´çš„åªä¸è¿‡æ˜¯æ¯”è¾ƒå¸¸è§çš„å‡ ç§æ–¹å¼ï¼Œtomcat + redis æ—©æœŸæ¯”è¾ƒå¸¸ç”¨ï¼Œä½†æ˜¯ä¼šé‡è€¦åˆåˆ° tomcat ä¸­ï¼›è¿‘äº›å¹´ï¼Œé€šè¿‡ spring session æ¥å®ç°ã€‚</p><h2 id="4-å‚è€ƒèµ„æ–™"><a href="#4-å‚è€ƒèµ„æ–™" class="headerlink" title="4. å‚è€ƒèµ„æ–™"></a>4. å‚è€ƒèµ„æ–™</h2><ul><li><a class="link" target="_blank" rel="noopener" href="https://github.com/L316476844/distributed-session">é›†ç¾¤/åˆ†å¸ƒå¼ç¯å¢ƒ Session çš„å‡ ç§ç­–ç•¥<i class="fas fa-external-link-alt"></i></a></li><li><a class="link" target="_blank" rel="noopener" href="https://juejin.im/post/5cd9037ee51d456e5c5babca">ä½ çœŸçš„äº†è§£ Cookie å’Œ Session å—<i class="fas fa-external-link-alt"></i></a></li><li><a class="link" target="_blank" rel="noopener" href="https://juejin.im/post/5aede266f265da0ba266e0ef">èŠä¸€èŠ session å’Œ cookie<i class="fas fa-external-link-alt"></i></a></li></ul></div><div class="article-nav"><div class="article-prev"><a class="prev" rel="prev" href="../9daafd62a188/"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item">åˆ†å¸ƒå¼é”åŸºæœ¬åŸç†</span> <span class="post-nav-item">ä¸Šä¸€ç¯‡</span></span></a></div><div class="article-next"><a class="next" rel="next" href="../b18eaf602c9b/"><span class="title flex-center"><span class="post-nav-title-item">ç½‘ç»œé€šä¿¡çŸ¥è¯†ç‚¹é¢ç»</span> <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div></div></div></div></div><div class="page-main-content-bottom"><footer class="footer"><div class="info-container"><div class="copyright-info info-item">&copy; <span>2021</span>&nbsp;-&nbsp; 2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">ä¹å¤©å›¾è…¾</a></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="website-count info-item"><span id="busuanzi_container_site_uv">è®¿é—®äººæ•°&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp; </span><span id="busuanzi_container_site_pv">æ€»è®¿é—®é‡&nbsp;<span id="busuanzi_value_site_pv"></span></span></div><div class="theme-info info-item">ç”± <a target="_blank" href="https://hexo.io">Hexo</a> é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.3</a></div></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="tools-list"><li class="tools-item page-aside-toggle"><i class="fas fa-outdent"></i></li></ul></div></div><div class="right-bottom-side-tools"><div class="side-tools-container"><ul class="side-tools-list"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-expand-width flex-center"><i class="fas fa-arrows-alt-h"></i></li><li class="tools-item tool-dark-light-toggle flex-center"><i class="fas fa-moon"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list"><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li><li class="tools-item tool-scroll-to-top flex-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><aside class="page-aside"><div class="post-toc-wrap"><div class="post-toc"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="nav-text">åˆ†å¸ƒå¼ä¼šè¯åŸºæœ¬åŸç†</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E7%AE%80%E4%BB%8B"><span class="nav-text">1. ç®€ä»‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF-Cookie"><span class="nav-text">1.1. ä»€ä¹ˆæ˜¯ Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E4%BB%80%E4%B9%88%E6%98%AF-Session"><span class="nav-text">1.2. ä»€ä¹ˆæ˜¯ Session</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-Cookie-%E5%92%8C-Session-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-text">1.3. Cookie å’Œ Session çš„åŒºåˆ«</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-Cookie-%E5%92%8C-Session%EF%BC%8C%E4%BB%96%E4%BB%AC%E6%9C%89%E4%BB%80%E4%B9%88%E5%85%B3%E8%81%94%EF%BC%9F"><span class="nav-text">1.4. ä¸ºä»€ä¹ˆéœ€è¦ Cookie å’Œ Sessionï¼Œä»–ä»¬æœ‰ä»€ä¹ˆå…³è”ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-%E5%A6%82%E6%9E%9C%E6%B5%8F%E8%A7%88%E5%99%A8%E7%A6%81%E7%94%A8-Cookie-%E6%80%8E%E4%B9%88%E5%8A%9E"><span class="nav-text">1.5. å¦‚æœæµè§ˆå™¨ç¦ç”¨ Cookie æ€ä¹ˆåŠ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%88%86%E5%B8%83%E5%BC%8F-Session"><span class="nav-text">2. åˆ†å¸ƒå¼ Session</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E7%B2%98%E6%80%A7-Session"><span class="nav-text">2.1. ç²˜æ€§ Session</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Session-%E5%A4%8D%E5%88%B6%E5%85%B1%E4%BA%AB"><span class="nav-text">2.2. Session å¤åˆ¶å…±äº«</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E5%9F%BA%E4%BA%8E%E7%BC%93%E5%AD%98%E7%9A%84-session-%E5%85%B1%E4%BA%AB"><span class="nav-text">2.3. åŸºäºç¼“å­˜çš„ session å…±äº«</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0"><span class="nav-text">3. å…·ä½“å®ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-JWT-Token"><span class="nav-text">3.1. JWT Token</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-tomcat-redis"><span class="nav-text">3.2. tomcat + redis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-spring-session-redis"><span class="nav-text">3.3. spring session + redis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-text">4. å‚è€ƒèµ„æ–™</span></a></li></ol></li></ol></div></div></aside><div class="image-viewer-container"><img src=""></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fas fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fas fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/dark-light-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/local-search.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/code-copy.js"></script><div class="post-scripts"><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/toc.js"></script></div></body></html>